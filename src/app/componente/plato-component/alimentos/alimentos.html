<div class="dialog-container">
  <!-- Header -->
  <div class="dialog-header">
    <h2 mat-dialog-title>
      <mat-icon>restaurant_menu</mat-icon>
      Alimentos del Plato: {{ platoNombre }}
    </h2>
    <button mat-icon-button mat-dialog-close (click)="cerrar()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Content -->
  <mat-dialog-content>
    <!-- Descripción del plato -->
    <div class="plato-info" *ngIf="platoInformacion">
      <p><strong>Descripción:</strong> {{ platoInformacion }}</p>
    </div>

    <mat-card *ngIf="!loading">
      <mat-card-content>
        <!-- Totales Nutricionales - PRIMERO -->
        <div class="totales-container" *ngIf="dataSource.data.length > 0">
          <h3>Totales Nutricionales del Plato</h3>
          <div class="totales-grid">
            <div class="total-item">
              <mat-icon>local_fire_department</mat-icon>
              <div class="total-info">
                <span class="total-label">Calorías Totales</span>
                <span class="total-value">{{ limitarDecimales(totalCalorias) }} kcal</span>
              </div>
            </div>
            <div class="total-item">
              <mat-icon>fitness_center</mat-icon>
              <div class="total-info">
                <span class="total-label">Proteínas</span>
                <span class="total-value">{{ limitarDecimales(totalProteinas) }} g</span>
              </div>
            </div>
            <div class="total-item">
              <mat-icon>bakery_dining</mat-icon>
              <div class="total-info">
                <span class="total-label">Carbohidratos</span>
                <span class="total-value">{{ limitarDecimales(totalCarbohidratos) }} g</span>
              </div>
            </div>
            <div class="total-item">
              <mat-icon>water_drop</mat-icon>
              <div class="total-info">
                <span class="total-label">Grasas</span>
                <span class="total-value">{{ limitarDecimales(totalGrasas) }} g</span>
              </div>
            </div>
            <div class="total-item">
              <mat-icon>grass</mat-icon>
              <div class="total-info">
                <span class="total-label">Fibra</span>
                <span class="total-value">{{ limitarDecimales(totalFibra) }} g</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Tabla de alimentos - DESPUÉS -->
        <div class="tabla-container">
          <table mat-table [dataSource]="dataSource" matSort class="tabla-alimentos">

            <!-- Columna Nombre del Alimento -->
            <ng-container matColumnDef="alimentoNombre">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Alimento</th>
              <td mat-cell *matCellDef="let element">
                <strong>{{ element.alimentoNombre }}</strong>
                <br>
                <small class="categoria">{{ element.categoriaNombre }}</small>
              </td>
            </ng-container>

            <!-- Columna Cantidad -->
            <ng-container matColumnDef="cantidad">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Cantidad</th>
              <td mat-cell *matCellDef="let element">
                {{ element.cantidad }} {{ element.unidad }}
              </td>
            </ng-container>

            <!-- Columna Calorías -->
            <ng-container matColumnDef="calorias">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Calorías</th>
              <td mat-cell *matCellDef="let element">
                {{ element.calorias }} kcal
              </td>
            </ng-container>

            <!-- Columna Proteínas -->
            <ng-container matColumnDef="proteina">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Proteínas</th>
              <td mat-cell *matCellDef="let element">
                {{ element.proteina }} g
              </td>
            </ng-container>

            <!-- Columna Carbohidratos -->
            <ng-container matColumnDef="carbohidrato">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Carbohidratos</th>
              <td mat-cell *matCellDef="let element">
                {{ element.carbohidrato }} g
              </td>
            </ng-container>

            <!-- Columna Grasas -->
            <ng-container matColumnDef="grasa">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Grasas</th>
              <td mat-cell *matCellDef="let element">
                {{ element.grasa }} g
              </td>
            </ng-container>

            <!-- Columna Fibra -->
            <ng-container matColumnDef="fibra">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Fibra</th>
              <td mat-cell *matCellDef="let element">
                {{ element.fibra }} g
              </td>
            </ng-container>

            <!-- Filas -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- Mensaje sin datos -->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                <div class="sin-datos">
                  <mat-icon>info</mat-icon>
                  <p>No se encontraron alimentos para este plato</p>
                </div>
              </td>
            </tr>
          </table>
        </div>

        <!-- Paginador -->
        <mat-paginator
          [pageSizeOptions]="[5, 10, 20]"
          showFirstLastButtons
          aria-label="Select page of alimentos"
        >
        </mat-paginator>
      </mat-card-content>
    </mat-card>

    <!-- Loading -->
    <div *ngIf="loading" class="loading-container">
      <p>Cargando alimentos...</p>
    </div>
  </mat-dialog-content>

  <!-- Actions -->
  <mat-dialog-actions align="end">
    <button mat-raised-button color="primary" (click)="cerrar()">
      Cerrar
    </button>
  </mat-dialog-actions>
</div>


