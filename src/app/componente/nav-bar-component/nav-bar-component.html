<mat-toolbar class="professional-nav">
  <mat-toolbar-row>

    <a class="brand" [routerLink]="'/'">
      <img ngSrc="assets/Logo.png" alt="MyCare" class="logo" height="1024" width="1024"/>
      <span class="brand-text">MyCare</span>
    </a>

    @if(esUsuario() || esNutricionista()) {
      <div class="nav-items left">

        @if(esUsuario()) {
          <a mat-button class="nav-link" routerLink="/dashboard" routerLinkActive="active-white">Dashboard</a>
          <a mat-button class="nav-link" routerLink="/Plato" routerLinkActive="active-white">Platos</a>
          <a mat-button class="nav-link" routerLink="/nuevo-edit" routerLinkActive="active-white">Nuevo Plato</a>
          <a mat-button class="nav-link" routerLink="/Alimento" routerLinkActive="active-white">Alimentos</a>
          <a mat-button class="nav-link" routerLink="/NuevoAlimento" routerLinkActive="active-white">Nuevo Alimento</a>
          <a mat-button class="nav-link" routerLink="/ListaNutricionista" routerLinkActive="active-white">Nutricionistas</a>
        }

        @if(esNutricionista()) {
          <a mat-button class="nav-link" routerLink="/Alimento" routerLinkActive="active-white">Alimentos</a>
          <a mat-button class="nav-link" routerLink="/NuevoAlimento" routerLinkActive="active-white">Nuevo Alimento</a>
          <a mat-button class="nav-link" routerLink="/Plato" routerLinkActive="active-white">Platos</a>
          <a mat-button class="nav-link" routerLink="/nuevo-edit" routerLinkActive="active-white">Nuevo Plato</a>
          <a mat-button class="nav-link" routerLink="/usuarios" routerLinkActive="active-white">Usuarios</a>
          <a mat-button class="nav-link" routerLink="/citas-programadas" routerLinkActive="active-white">Citas Programadas</a>
        }
      </div>
    }

    <span class="spacer"></span>

    @if(!esUsuario() && !esNutricionista()) {
      <div class="nav-items right">
        <a mat-button class="nav-link" routerLink="/registro" routerLinkActive="active-white">Registrarse</a>
        <a mat-button class="nav-link" routerLink="/login" routerLinkActive="active-white">Iniciar Sesión</a>
      </div>
    }

    @if(esUsuario() || esNutricionista()) {
      <button mat-icon-button (click)="toggleSidebar()" class="chat-btn">
        <mat-icon>chat</mat-icon>
      </button>

      <button mat-icon-button [matMenuTriggerFor]="settingsMenu" class="settings-btn">
        <mat-icon>settings</mat-icon>
      </button>

      <mat-menu #settingsMenu="matMenu">
      @if(esUsuario()) {
        <button mat-menu-item [routerLink]="'/config'">
          <mat-icon>person</mat-icon><span>Mi Perfil</span>
        </button>
      }
        <button mat-menu-item (click)="onLogout()">
          <mat-icon>logout</mat-icon><span>Cerrar Sesión</span>
        </button>
      </mat-menu>
    }

  </mat-toolbar-row>
</mat-toolbar>

<!-- Overlay oscuro cuando el sidebar está abierto -->
@if(isSidebarOpen) {
  <div class="sidebar-overlay" (click)="closeSidebar()"></div>
}

<!-- Sidebar de chat -->
<div class="chat-sidebar" [class.open]="isSidebarOpen">
  <div class="sidebar-header">
    <h2>Chat Asistente</h2>
    <button mat-icon-button (click)="closeSidebar()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="sidebar-content">
    <app-gemini-component></app-gemini-component>
  </div>
</div>

